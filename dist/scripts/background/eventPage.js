var r=/:\/\/(.[^/]+)/,prevWebsite='',myURL='about:blank',msgs='';console.log('start');var URL=chrome.extension.getURL('../../common/news_websites.json'),request=new XMLHttpRequest;if(request.open('GET',URL,!1),request.send(null),200===request.status)msgs=JSON.parse(request.responseText);var websites=msgs.Website,domainsList=msgs.Domain,comments=msgs.Comments,newsOriginContextMenu={id:'SsSorigin',title:'Get probable News ',contexts:['selection']};function checkWebsite(e){if(prevWebsite!==e){console.log('visiting: '+e);for(var t=0;t<1964;t++)if(e===domainsList[t]||e.includes(domainsList[t])||domainsList[t].includes(e)){var s={type:'basic',title:'Webite Info: '+websites[t],message:'Comments: '+comments[t],iconUrl:'../../assets/icon/72.png'};chrome.notifications.create(s);break;}}prevWebsite=e;}chrome.contextMenus.create(newsOriginContextMenu),chrome.contextMenus.onClicked.addListener(function(e){if('SsSorigin'===e.menuItemId&&e.selectionText){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=JSON.parse(t.responseText),s=e.HIGH,n={type:'basic',title:'Origin probabilities: ',message:'High:'+s+', SOME: '+e.SOME,expandedMessage:'High'+e.MINIMAL,iconUrl:'../../assets/icon/72.png'};console.log(s),chrome.notifications.create(n);}},t.open('GET','http://18.221.117.28:7000/pred?text='+e.selectionText,!0),t.send();}}),chrome.tabs.onUpdated.addListener(function(e,t,s){chrome.tabs.getSelected(null,function(e){myURL=e.url,k=myURL,k=myURL.match(r)[1],myWebsite=k.replace(/^(https?:\/\/)?(www\.)?/,''),checkWebsite(myWebsite),chrome.storage.sync.set({website:myWebsite});});});