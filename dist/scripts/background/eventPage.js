var r=/:\/\/(.[^/]+)/,prevWebsite='',myURL='about:blank',msgs='',websites=[],domainsList=[],comments=[];async function getNewsWebsites(e){const t=await fetch(e);msgs=await t.json(),websites=msgs.Website,domainsList=msgs.Domain,comments=msgs.Comments;}var URL=chrome.runtime.getURL('../../common/news_websites.json');getNewsWebsites(URL),setTimeout(function(){console.log(msgs);},1e3),void 0!==chrome.contextMenus&&chrome.contextMenus.removeAll();var newsOriginContextMenu={id:'SsSorigin',title:'Get probable News ',contexts:['selection']};function checkWebsite(e){if(prevWebsite!==e){console.log('visiting: '+e);for(var t=0;t<domainsList.length;t++)if(e===domainsList[t]||e.includes(domainsList[t])||domainsList[t].includes(e)){var s={type:'basic',title:'Webite Info: '+websites[t],message:'Comments: '+comments[t],iconUrl:'../../assets/icon/72.png'};chrome.notifications.create(s);break;}prevWebsite=e;}}chrome.contextMenus.create(newsOriginContextMenu),chrome.contextMenus.onClicked.addListener(function(e){if('SsSorigin'===e.menuItemId&&e.selectionText){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=JSON.parse(t.responseText),s=e.HIGH,i={type:'basic',title:'Origin probabilities: ',message:'High:'+s+', SOME: '+e.SOME,expandedMessage:'High'+e.MINIMAL,iconUrl:'../../assets/icon/72.png'};console.log(s),chrome.notifications.create(i);}},t.open('GET','http://18.221.117.28:7000/pred?text='+e.selectionText,!0),t.send();}}),chrome.tabs.onUpdated.addListener(function(e,t,s){if('complete'!==t.status)return;if(void 0===s.url)return;const i=(myURL=s.url).match(r)[1].replace(/^(https?:\/\/)?(www\.)?/,'');checkWebsite(i),chrome.storage.sync.set({website:i});});